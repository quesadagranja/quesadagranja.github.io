---
layout: post
title: "pgd: An R package"
date: 2021-04-10
categories: [one, two]
---
I just released on my GitHub account the first package in **R** (as far as I know) focused on the [**Proper Generalized Decomposition**](https://en.wikipedia.org/wiki/Proper_generalized_decomposition)! I've unsurprisingly called it `pgd` and can be found [here](https://github.com/quesadagranja/pgd "here"). At the moment it only solves boundary value problems based on the **2D Poisson's equation** in Cartesian coordinates. Depending on its "success", I can consider extending it with other differential equations.

## Introduction
The package implements the methodology developed in the article [*A new family of solvers for some classes of multidimensional partial differential equations encountered in kinetic theory modeling of complex fluids*](https://hal.archives-ouvertes.fr/hal-01004909/document), by Ammar et al., which was the first paper to describe the PGD (although without naming it as such). This package numerically solves two-dimensional Poisson's equations in Cartesian coordinates, that is, equations of the type

$$
\Delta T(x,y) = - f(x,y)
$$

or, equivalently,

$$
\left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} \right) T(x,y) = -f(x,y)\text{,}
$$

where $T$ is a scalar function of $(x,y)$.

The problem is defined in the rectangular domain

$$
(x,y) \in \Omega = \left(-L_x, +L_x\right) \times \left(-L_y, +L_y \right)
$$

with homogeneous (vanishing) boundary conditions.

The PGD iterative algorithm will seek the solution of the problem in the separate form

$$
T(x,y)= \sum^{\infty}_{j=1} \alpha_j \, F_j(x) \, G_j(y) \text{,}
$$

where functions $F_j(x)$ and $G_j(y)$ are the $j$-th separate components (or *modes*, in the PGD jargon) of the solution. Since the *modes* come in the form of normalized vectors, a coefficient $\alpha_j$ is required to provide the right solution. The number of *modes* generated by the PGD iterative algorithm cannot be known beforehand, but can be controlled by the user.

Due to the separate nature of PGD, the function $f(x,y)$ must also be provided in a separate form.

## Installation
The installation of the ``pgd`` package in your favorite R environment is really easy and can be done in three steps. First, install the ``devtools`` package if you don't have it. To do so, type:

{% highlight r linenos %}
install.packages("devtools")
{% endhighlight %}

Then, install the ``pgd`` package from my repo:

{% highlight r linenos %}
library(devtools)
install_github("quesadagranja/pgd")
{% endhighlight %}

Finally, load the package:

{% highlight r linenos %}
install.packages("pgd")
{% endhighlight %}

That's it!

## Using the package
The package only contains the function ``pgd::poisson_2D()``, which computes the 2D Poisson's equation using PGD. The function has six input arguments, of which two are optional.

The mandatory arguments are the source function ``src``, defined by $f(x,y)$; the number of nodes ``n`` to discretize the domain $\Omega$; the nodes representing the boundary conditions ``bc``; and the limits of the mesh ``mlim`` described by $-L_x$, $+L_x$, $-L_y$, $+L_y$. Since all these arguments are specified for variables $x$ and $y$, lists of the type ``list(x=, y=)`` must be used.

The optional arguments have to do with the conditions of the iterative PGD algorithms: the error tolerance ``tol`` and the maximum number of iterations ``maxiter``. The latter must be specified in a list for both the outer loop ``f_iter`` and the inner loop ``r_iter``.

The output that the function returns is a list of four components: the list of matrices ``f`` with the resulting modes for variables $x$ and $y$; the vector ``alpha`` of coefficients; the list of coordinates ``coor`` for variables $x$ and $y$; and the resulting surface ``t``.

## Examples
